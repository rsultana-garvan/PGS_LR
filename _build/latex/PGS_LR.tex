%% Generated by Sphinx.
\def\sphinxdocclass{jupyterBook}
\documentclass[letterpaper,10pt,english]{jupyterBook}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax
\ifdefined\pdfimageresolution
    \pdfimageresolution= \numexpr \dimexpr1in\relax/\sphinxpxdimen\relax
\fi
%% let collapsible pdf bookmarks panel have high depth per default
\PassOptionsToPackage{bookmarksdepth=5}{hyperref}
%% turn off hyperref patch of \index as sphinx.xdy xindy module takes care of
%% suitable \hyperpage mark-up, working around hyperref-xindy incompatibility
\PassOptionsToPackage{hyperindex=false}{hyperref}
%% memoir class requires extra handling
\makeatletter\@ifclassloaded{memoir}
{\ifdefined\memhyperindexfalse\memhyperindexfalse\fi}{}\makeatother

\PassOptionsToPackage{warn}{textcomp}

\catcode`^^^^00a0\active\protected\def^^^^00a0{\leavevmode\nobreak\ }
\usepackage{cmap}
\usepackage{fontspec}
\defaultfontfeatures[\rmfamily,\sffamily,\ttfamily]{}
\usepackage{amsmath,amssymb,amstext}
\usepackage{polyglossia}
\setmainlanguage{english}



\setmainfont{FreeSerif}[
  Extension      = .otf,
  UprightFont    = *,
  ItalicFont     = *Italic,
  BoldFont       = *Bold,
  BoldItalicFont = *BoldItalic
]
\setsansfont{FreeSans}[
  Extension      = .otf,
  UprightFont    = *,
  ItalicFont     = *Oblique,
  BoldFont       = *Bold,
  BoldItalicFont = *BoldOblique,
]
\setmonofont{FreeMono}[
  Extension      = .otf,
  UprightFont    = *,
  ItalicFont     = *Oblique,
  BoldFont       = *Bold,
  BoldItalicFont = *BoldOblique,
]



\usepackage[Bjarne]{fncychap}
\usepackage[,numfigreset=1,mathnumfig]{sphinx}

\fvset{fontsize=\small}
\usepackage{geometry}


% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}


\usepackage{sphinxmessages}



        % Start of preamble defined in sphinx-jupyterbook-latex %
         \usepackage[Latin,Greek]{ucharclasses}
        \usepackage{unicode-math}
        % fixing title of the toc
        \addto\captionsenglish{\renewcommand{\contentsname}{Contents}}
        \hypersetup{
            pdfencoding=auto,
            psdextra
        }
        % End of preamble defined in sphinx-jupyterbook-latex %
        

\title{PGS logistic regression optimization}
\date{Nov 09, 2022}
\release{}
\author{Razvan Sultana}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{}
\makeindex
\begin{document}

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{intro::doc}}


\sphinxAtStartPar
This project applies logistic regression (LR) to rank SNPs from several PGS datasets as predictors of Parkinsonâ€™s disease.

\sphinxAtStartPar
Click on each dataset link to explore the details.
\begin{itemize}
\item {} 
\sphinxAtStartPar
{\hyperref[\detokenize{Cooper::doc}]{\sphinxcrossref{Cooper 142 SNPs set}}}

\end{itemize}

\sphinxstepscope


\chapter{Cooper 142 SNPs set}
\label{\detokenize{Cooper:cooper-142-snps-set}}\label{\detokenize{Cooper::doc}}

\section{Preparation}
\label{\detokenize{Cooper:preparation}}

\subsection{Import required packages.}
\label{\detokenize{Cooper:import-required-packages}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{os}\PYG{o}{,} \PYG{n+nn}{sys}\PYG{o}{,} \PYG{n+nn}{warnings}
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{k+kn}{import} \PYG{n+nn}{pandas} \PYG{k}{as} \PYG{n+nn}{pd}
\PYG{k+kn}{from} \PYG{n+nn}{sklearn}\PYG{n+nn}{.}\PYG{n+nn}{linear\PYGZus{}model} \PYG{k+kn}{import} \PYG{n}{LogisticRegression}
\PYG{k+kn}{from} \PYG{n+nn}{sklearn}\PYG{n+nn}{.}\PYG{n+nn}{metrics} \PYG{k+kn}{import} \PYG{n}{roc\PYGZus{}auc\PYGZus{}score}
\PYG{k+kn}{from} \PYG{n+nn}{sklearn}\PYG{n+nn}{.}\PYG{n+nn}{model\PYGZus{}selection} \PYG{k+kn}{import} \PYG{n}{GridSearchCV}
\PYG{k+kn}{from} \PYG{n+nn}{sklearn}\PYG{n+nn}{.}\PYG{n+nn}{exceptions} \PYG{k+kn}{import} \PYG{n}{ConvergenceWarning}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}

\end{sphinxuseclass}

\subsection{Read input matrix with genotypes}
\label{\detokenize{Cooper:read-input-matrix-with-genotypes}}
\sphinxAtStartPar
The matrix contains the genotypes from AMP\sphinxhyphen{}PD/MGRB dataset for 140 SNPs.

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{table} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{read\PYGZus{}csv}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{data/matrix.txt}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{sep}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}t}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{table}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
            participant\PYGZus{}id  phenotype      cohort gender inv\PYGZus{}genotype  \PYGZbs{}
0     SY\PYGZhy{}NIH\PYGZus{}INVAA791MKCET          1  STEADY\PYGZhy{}PD3      M           NI   
1     SY\PYGZhy{}NIH\PYGZus{}INVEP886EEYYL          1  STEADY\PYGZhy{}PD3      M           NI   
2     SY\PYGZhy{}NIH\PYGZus{}INVFM717GWDX4          1  STEADY\PYGZhy{}PD3      F           NI   
3     SY\PYGZhy{}NIH\PYGZus{}INVNN611MKKN9          1  STEADY\PYGZhy{}PD3      M           NI   
4     SY\PYGZhy{}NIH\PYGZus{}INVRB171EXGUK          1  STEADY\PYGZhy{}PD3      M           II   
...                    ...        ...         ...    ...          ...   
3107                 BABQX          0        MGRB      M           II   
3108                 BABRB          0        MGRB      F           II   
3109                 BABRE          0        MGRB      M           NI   
3110                 ZAAAB          0        MGRB      M           NI   
3111                 AABUO          0        MGRB      F           NN   

      rs2275579  rs144115304  rs115581042  rs79531911  rs138844738  ...  \PYGZbs{}
0             0            0            0           0            0  ...   
1             0            0            0           0            0  ...   
2             0            0            0           0            0  ...   
3             0            0            0           0            0  ...   
4             0            1            1           1            0  ...   
...         ...          ...          ...         ...          ...  ...   
3107          0            0            0           0            0  ...   
3108          0            0            0           0            0  ...   
3109          0            0            0           0            0  ...   
3110          0            0            0           0            0  ...   
3111          0            0            0           0            0  ...   

      rs10448130  rs34288580  rs34992950  rs7387252  rs2410595  rs41311559  \PYGZbs{}
0              2           2           1          2          1           0   
1              0           0           0          0          0           0   
2              0           0           0          0          0           0   
3              1           0           1          1          0           0   
4              1           1           0          1          0           0   
...          ...         ...         ...        ...        ...         ...   
3107           1           0           0          0          0           0   
3108           0           0           0          0          0           0   
3109           1           0           0          0          0           0   
3110           2           1           1          1          0           0   
3111           1           0           0          0          0           0   

      rs148894916  rs112957100  rs143756122  rs148514732  
0               0            0            0            0  
1               0            0            0            0  
2               0            0            0            0  
3               0            0            0            0  
4               0            0            0            0  
...           ...          ...          ...          ...  
3107            0            0            0            0  
3108            0            0            0            0  
3109            0            0            0            0  
3110            0            0            0            0  
3111            0            0            0            0  

[3112 rows x 145 columns]
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Distribution of data}
\label{\detokenize{Cooper:distribution-of-data}}

\subsubsection{Distribution by phenotype}
\label{\detokenize{Cooper:distribution-by-phenotype}}
\sphinxAtStartPar
(0=Control, 1=Case)

\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{table}\PYG{o}{.}\PYG{n}{groupby}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{phenotype}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{participant\PYGZus{}id}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{nunique}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
phenotype
0    1556
1    1556
Name: participant\PYGZus{}id, dtype: int64
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsubsection{Distribution by gender/phenotype}
\label{\detokenize{Cooper:distribution-by-gender-phenotype}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{table}\PYG{o}{.}\PYG{n}{groupby}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{gender}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{phenotype}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{participant\PYGZus{}id}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{nunique}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
gender  phenotype
F       0            567
        1            567
M       0            989
        1            989
Name: participant\PYGZus{}id, dtype: int64
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsubsection{Distribution by gender/phenotype/inv8\_001 genotype}
\label{\detokenize{Cooper:distribution-by-gender-phenotype-inv8-001-genotype}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{table}\PYG{o}{.}\PYG{n}{groupby}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{gender}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{phenotype}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{inv\PYGZus{}genotype}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{participant\PYGZus{}id}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{nunique}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
gender  phenotype  inv\PYGZus{}genotype
F       0          II              195
                   NI              259
                   NN              113
        1          II              175
                   NI              270
                   NN              122
M       0          II              318
                   NI              480
                   NN              191
        1          II              296
                   NI              477
                   NN              216
Name: participant\PYGZus{}id, dtype: int64
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{All participants}
\label{\detokenize{Cooper:all-participants}}

\subsection{Logistic regression model}
\label{\detokenize{Cooper:logistic-regression-model}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{pd}\PYG{o}{.}\PYG{n}{set\PYGZus{}option}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{display.max\PYGZus{}rows}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{150}\PYG{p}{)}
\PYG{n}{X} \PYG{o}{=} \PYG{n}{table}\PYG{p}{[}\PYG{n}{table}\PYG{o}{.}\PYG{n}{columns}\PYG{p}{[}\PYG{l+m+mi}{5}\PYG{p}{:}\PYG{p}{]}\PYG{p}{]}
\PYG{n}{Y} \PYG{o}{=} \PYG{n}{table}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{phenotype}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{lr} \PYG{o}{=} \PYG{n}{LogisticRegression}\PYG{p}{(}\PYG{n}{random\PYGZus{}state}\PYG{o}{=}\PYG{l+m+mi}{42}\PYG{p}{,} \PYG{n}{solver}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{saga}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{n\PYGZus{}jobs}\PYG{o}{=}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{penalty}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{elasticnet}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{table}\PYG{o}{.}\PYG{n}{groupby}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{phenotype}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{participant\PYGZus{}id}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{nunique}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
phenotype
0    1556
1    1556
Name: participant\PYGZus{}id, dtype: int64
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Grid search for 3 hyperparameters}
\label{\detokenize{Cooper:grid-search-for-3-hyperparameters}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} parameters = \PYGZob{}\PYGZsq{}C\PYGZsq{}: [0.005, 0.01, 0.02, 0.05, 0.1, 0.5, 1, 10, 20, 30],}
\PYG{c+c1}{\PYGZsh{}              \PYGZsq{}max\PYGZus{}iter\PYGZsq{}: [10, 25, 50, 75, 100, 150, 200, 400, 800, 1600],}
\PYG{c+c1}{\PYGZsh{}              \PYGZsq{}l1\PYGZus{}ratio\PYGZsq{}: [1, 0.9, 0.8, 0.7, 0.6, 0.5, 0.4, 0.3, 0.2, 0.1]\PYGZcb{}}

\PYG{n}{parameters} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+m+mf}{0.01}\PYG{p}{,} \PYG{l+m+mf}{0.02}\PYG{p}{,} \PYG{l+m+mf}{0.05}\PYG{p}{]}\PYG{p}{,}
              \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{max\PYGZus{}iter}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{l+m+mi}{25}\PYG{p}{,} \PYG{l+m+mi}{50}\PYG{p}{]}\PYG{p}{,}
              \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{l1\PYGZus{}ratio}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mf}{0.9}\PYG{p}{,} \PYG{l+m+mf}{0.8}\PYG{p}{]}\PYG{p}{\PYGZcb{}}

\PYG{n}{grid\PYGZus{}lr} \PYG{o}{=} \PYG{n}{GridSearchCV}\PYG{p}{(}\PYG{n}{lr}\PYG{p}{,} \PYG{n}{parameters}\PYG{p}{,} \PYG{n}{verbose}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{,} \PYG{n}{scoring}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{roc\PYGZus{}auc}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{n\PYGZus{}jobs}\PYG{o}{=}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{cv}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{)}
\PYG{k}{if} \PYG{o+ow}{not} \PYG{n}{sys}\PYG{o}{.}\PYG{n}{warnoptions}\PYG{p}{:}
    \PYG{n}{warnings}\PYG{o}{.}\PYG{n}{simplefilter}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ignore}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{category}\PYG{o}{=}\PYG{n}{ConvergenceWarning}\PYG{p}{)}
    \PYG{n}{os}\PYG{o}{.}\PYG{n}{environ}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{PYTHONWARNINGS}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ignore}\PYG{l+s+s2}{\PYGZdq{}} \PYG{c+c1}{\PYGZsh{} Also affect subprocesses}
\PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{n}{X}\PYG{p}{,} \PYG{n}{Y}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
GridSearchCV(cv=10,
             estimator=LogisticRegression(n\PYGZus{}jobs=\PYGZhy{}1, penalty=\PYGZsq{}elasticnet\PYGZsq{},
                                          random\PYGZus{}state=42, solver=\PYGZsq{}saga\PYGZsq{}),
             n\PYGZus{}jobs=\PYGZhy{}1,
             param\PYGZus{}grid=\PYGZob{}\PYGZsq{}C\PYGZsq{}: [0.01, 0.02, 0.05], \PYGZsq{}l1\PYGZus{}ratio\PYGZsq{}: [1, 0.9, 0.8],
                         \PYGZsq{}max\PYGZus{}iter\PYGZsq{}: [10, 25, 50]\PYGZcb{},
             scoring=\PYGZsq{}roc\PYGZus{}auc\PYGZsq{}, verbose=False)
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Best estimator}
\label{\detokenize{Cooper:best-estimator}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{best\PYGZus{}lr} \PYG{o}{=} \PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{best\PYGZus{}estimator\PYGZus{}}

\PYG{n}{max\PYGZus{}auc\PYGZus{}score} \PYG{o}{=} \PYG{n}{roc\PYGZus{}auc\PYGZus{}score}\PYG{p}{(}\PYG{n}{Y}\PYG{p}{,} \PYG{n}{best\PYGZus{}lr}\PYG{o}{.}\PYG{n}{predict\PYGZus{}proba}\PYG{p}{(}\PYG{n}{X}\PYG{p}{)}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{coefs} \PYG{o}{=} \PYG{n}{best\PYGZus{}lr}\PYG{o}{.}\PYG{n}{coef\PYGZus{}}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{p}{:}\PYG{p}{]}
\PYG{n}{num\PYGZus{}coef} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n}{coefs} \PYG{o}{!=} \PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{n}{X\PYGZus{}header} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{n}{X}\PYG{o}{.}\PYG{n}{columns}\PYG{p}{)}

\PYG{n}{data\PYGZus{}array} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{vstack}\PYG{p}{(}\PYG{p}{(}\PYG{n}{X\PYGZus{}header}\PYG{p}{,} \PYG{n}{coefs}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{model\PYGZus{}coefs} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n}{data}\PYG{o}{=}\PYG{n}{data\PYGZus{}array}\PYG{o}{.}\PYG{n}{T}\PYG{p}{,} \PYG{n}{columns}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{SNP}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Coefficient}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Max AUC score:}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{max\PYGZus{}auc\PYGZus{}score}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Non\PYGZhy{}zero coefficients: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{num\PYGZus{}coef}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Best estimator: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{best\PYGZus{}estimator\PYGZus{}}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Scorer: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{scorer\PYGZus{}}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Best params: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{best\PYGZus{}params\PYGZus{}}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Best score: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{best\PYGZus{}score\PYGZus{}}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{m} \PYG{o}{=} \PYG{n}{model\PYGZus{}coefs}\PYG{p}{[}\PYG{n}{model\PYGZus{}coefs}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Coefficient}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{!=} \PYG{l+m+mi}{0} \PYG{p}{]}\PYG{o}{.}\PYG{n}{sort\PYGZus{}values}\PYG{p}{(}\PYG{n}{by}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Coefficient}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{m} \PYG{o}{=} \PYG{n}{m}\PYG{o}{.}\PYG{n}{reset\PYGZus{}index}\PYG{p}{(}\PYG{n}{drop}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}\PYG{o}{.}\PYG{n}{assign}\PYG{p}{(}\PYG{n}{Index}\PYG{o}{=}\PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{m}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{m}\PYG{o}{.}\PYG{n}{Index}\PYG{o}{=} \PYG{n}{m}\PYG{o}{.}\PYG{n}{Index} \PYG{o}{+} \PYG{l+m+mi}{1}
\PYG{n}{m}\PYG{o}{.}\PYG{n}{set\PYGZus{}index}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Index}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Max AUC score:0.5551641873897212

Non\PYGZhy{}zero coefficients: 2

Best estimator: LogisticRegression(C=0.02, l1\PYGZus{}ratio=1, max\PYGZus{}iter=25, n\PYGZus{}jobs=\PYGZhy{}1,
                   penalty=\PYGZsq{}elasticnet\PYGZsq{}, random\PYGZus{}state=42, solver=\PYGZsq{}saga\PYGZsq{})
Scorer: make\PYGZus{}scorer(roc\PYGZus{}auc\PYGZus{}score, needs\PYGZus{}threshold=True)
Best params: \PYGZob{}\PYGZsq{}C\PYGZsq{}: 0.02, \PYGZsq{}l1\PYGZus{}ratio\PYGZsq{}: 1, \PYGZsq{}max\PYGZus{}iter\PYGZsq{}: 25\PYGZcb{}
Best score: 0.5492252417764205
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
              SNP Coefficient
Index                        
1      rs11248057    0.055163
2       rs3806760    0.098122
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Males}
\label{\detokenize{Cooper:males}}

\subsection{Logistic regression model}
\label{\detokenize{Cooper:id1}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{table1} \PYG{o}{=} \PYG{n}{table}\PYG{p}{[}\PYG{n}{table}\PYG{o}{.}\PYG{n}{gender} \PYG{o}{==} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{M}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}
\PYG{n}{X} \PYG{o}{=} \PYG{n}{table1}\PYG{p}{[}\PYG{n}{table1}\PYG{o}{.}\PYG{n}{columns}\PYG{p}{[}\PYG{l+m+mi}{5}\PYG{p}{:}\PYG{p}{]}\PYG{p}{]}
\PYG{n}{Y} \PYG{o}{=} \PYG{n}{table1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{phenotype}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{lr} \PYG{o}{=} \PYG{n}{LogisticRegression}\PYG{p}{(}\PYG{n}{random\PYGZus{}state}\PYG{o}{=}\PYG{l+m+mi}{42}\PYG{p}{,} \PYG{n}{solver}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{saga}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{n\PYGZus{}jobs}\PYG{o}{=}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{penalty}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{elasticnet}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{table1}\PYG{o}{.}\PYG{n}{groupby}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{phenotype}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{participant\PYGZus{}id}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{nunique}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
phenotype
0    989
1    989
Name: participant\PYGZus{}id, dtype: int64
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Grid search for 3 hyperparameters}
\label{\detokenize{Cooper:id2}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} parameters = \PYGZob{}\PYGZsq{}C\PYGZsq{}: [0.005, 0.01, 0.02, 0.05, 0.1, 0.5, 1, 10, 20, 30],}
\PYG{c+c1}{\PYGZsh{}               \PYGZsq{}max\PYGZus{}iter\PYGZsq{}: [10, 25, 50, 75, 100, 150, 200, 400, 800, 1600],}
\PYG{c+c1}{\PYGZsh{}               \PYGZsq{}l1\PYGZus{}ratio\PYGZsq{}: [1, 0.9, 0.8, 0.7, 0.6, 0.5, 0.4, 0.3, 0.2, 0.1]\PYGZcb{}}

\PYG{n}{parameters} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+m+mf}{0.01}\PYG{p}{,} \PYG{l+m+mf}{0.02}\PYG{p}{]}\PYG{p}{,}
              \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{max\PYGZus{}iter}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+m+mi}{75}\PYG{p}{,} \PYG{l+m+mi}{100}\PYG{p}{,} \PYG{l+m+mi}{150}\PYG{p}{]}\PYG{p}{,}
              \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{l1\PYGZus{}ratio}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+m+mf}{0.2}\PYG{p}{,} \PYG{l+m+mf}{0.1}\PYG{p}{]}\PYG{p}{\PYGZcb{}}

\PYG{n}{grid\PYGZus{}lr} \PYG{o}{=} \PYG{n}{GridSearchCV}\PYG{p}{(}\PYG{n}{lr}\PYG{p}{,} \PYG{n}{parameters}\PYG{p}{,} \PYG{n}{verbose}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{,} \PYG{n}{scoring}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{roc\PYGZus{}auc}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{n\PYGZus{}jobs}\PYG{o}{=}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{cv}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{)}
\PYG{k}{if} \PYG{o+ow}{not} \PYG{n}{sys}\PYG{o}{.}\PYG{n}{warnoptions}\PYG{p}{:}
    \PYG{n}{warnings}\PYG{o}{.}\PYG{n}{simplefilter}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ignore}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{category}\PYG{o}{=}\PYG{n}{ConvergenceWarning}\PYG{p}{)}
    \PYG{n}{os}\PYG{o}{.}\PYG{n}{environ}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{PYTHONWARNINGS}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ignore}\PYG{l+s+s2}{\PYGZdq{}} \PYG{c+c1}{\PYGZsh{} Also affect subprocesses}
\PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{n}{X}\PYG{p}{,} \PYG{n}{Y}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
GridSearchCV(cv=10,
             estimator=LogisticRegression(n\PYGZus{}jobs=\PYGZhy{}1, penalty=\PYGZsq{}elasticnet\PYGZsq{},
                                          random\PYGZus{}state=42, solver=\PYGZsq{}saga\PYGZsq{}),
             n\PYGZus{}jobs=\PYGZhy{}1,
             param\PYGZus{}grid=\PYGZob{}\PYGZsq{}C\PYGZsq{}: [0.01, 0.02], \PYGZsq{}l1\PYGZus{}ratio\PYGZsq{}: [0.2, 0.1],
                         \PYGZsq{}max\PYGZus{}iter\PYGZsq{}: [75, 100, 150]\PYGZcb{},
             scoring=\PYGZsq{}roc\PYGZus{}auc\PYGZsq{}, verbose=False)
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Best estimator}
\label{\detokenize{Cooper:id3}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{best\PYGZus{}lr} \PYG{o}{=} \PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{best\PYGZus{}estimator\PYGZus{}}

\PYG{n}{max\PYGZus{}auc\PYGZus{}score} \PYG{o}{=} \PYG{n}{roc\PYGZus{}auc\PYGZus{}score}\PYG{p}{(}\PYG{n}{Y}\PYG{p}{,} \PYG{n}{best\PYGZus{}lr}\PYG{o}{.}\PYG{n}{predict\PYGZus{}proba}\PYG{p}{(}\PYG{n}{X}\PYG{p}{)}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{coefs} \PYG{o}{=} \PYG{n}{best\PYGZus{}lr}\PYG{o}{.}\PYG{n}{coef\PYGZus{}}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{p}{:}\PYG{p}{]}
\PYG{n}{num\PYGZus{}coef} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n}{coefs} \PYG{o}{!=} \PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{n}{X\PYGZus{}header} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{n}{X}\PYG{o}{.}\PYG{n}{columns}\PYG{p}{)}

\PYG{n}{data\PYGZus{}array} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{vstack}\PYG{p}{(}\PYG{p}{(}\PYG{n}{X\PYGZus{}header}\PYG{p}{,} \PYG{n}{coefs}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{model\PYGZus{}coefs} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n}{data}\PYG{o}{=}\PYG{n}{data\PYGZus{}array}\PYG{o}{.}\PYG{n}{T}\PYG{p}{,} \PYG{n}{columns}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{SNP}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Coefficient}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Max AUC score:}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{max\PYGZus{}auc\PYGZus{}score}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Non\PYGZhy{}zero coefficients: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{num\PYGZus{}coef}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Best estimator: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{best\PYGZus{}estimator\PYGZus{}}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Scorer: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{scorer\PYGZus{}}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Best params: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{best\PYGZus{}params\PYGZus{}}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Best score: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{best\PYGZus{}score\PYGZus{}}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{m} \PYG{o}{=} \PYG{n}{model\PYGZus{}coefs}\PYG{p}{[}\PYG{n}{model\PYGZus{}coefs}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Coefficient}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{!=} \PYG{l+m+mi}{0} \PYG{p}{]}\PYG{o}{.}\PYG{n}{sort\PYGZus{}values}\PYG{p}{(}\PYG{n}{by}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Coefficient}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{m} \PYG{o}{=} \PYG{n}{m}\PYG{o}{.}\PYG{n}{reset\PYGZus{}index}\PYG{p}{(}\PYG{n}{drop}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}\PYG{o}{.}\PYG{n}{assign}\PYG{p}{(}\PYG{n}{Index}\PYG{o}{=}\PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{m}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{m}\PYG{o}{.}\PYG{n}{Index}\PYG{o}{=} \PYG{n}{m}\PYG{o}{.}\PYG{n}{Index} \PYG{o}{+} \PYG{l+m+mi}{1}
\PYG{n}{m}\PYG{o}{.}\PYG{n}{set\PYGZus{}index}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Index}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Max AUC score:0.6243225531401534

Non\PYGZhy{}zero coefficients: 37

Best estimator: LogisticRegression(C=0.01, l1\PYGZus{}ratio=0.1, n\PYGZus{}jobs=\PYGZhy{}1, penalty=\PYGZsq{}elasticnet\PYGZsq{},
                   random\PYGZus{}state=42, solver=\PYGZsq{}saga\PYGZsq{})
Scorer: make\PYGZus{}scorer(roc\PYGZus{}auc\PYGZus{}score, needs\PYGZus{}threshold=True)
Best params: \PYGZob{}\PYGZsq{}C\PYGZsq{}: 0.01, \PYGZsq{}l1\PYGZus{}ratio\PYGZsq{}: 0.1, \PYGZsq{}max\PYGZus{}iter\PYGZsq{}: 100\PYGZcb{}
Best score: 0.5620659282996945
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
               SNP Coefficient
Index                         
1        rs7520918    \PYGZhy{}0.10687
2      rs112270735   \PYGZhy{}0.077184
3         rs444618   \PYGZhy{}0.054004
4       rs13161496   \PYGZhy{}0.044109
5        rs3733349   \PYGZhy{}0.035941
6        rs3785891   \PYGZhy{}0.022054
7         rs494312   \PYGZhy{}0.015573
8       rs62190394   \PYGZhy{}0.008948
9       rs12995314    \PYGZhy{}0.00536
10      rs72838312   \PYGZhy{}0.004366
11     rs142448570    \PYGZhy{}0.00037
12      rs74609071    0.000361
13       rs4028634      0.0029
14      rs17016235     0.00292
15       rs1501467    0.006768
16       rs7682766    0.007628
17       rs6532190    0.010966
18        rs379066    0.015095
19       rs2412116    0.015274
20          rs5848    0.015471
21        rs764324     0.01817
22      rs11601088    0.019219
23      rs10110312    0.028269
24       rs4897753    0.029363
25       rs6599389     0.03295
26      rs11097213    0.036052
27       rs3822023    0.041542
28      rs79828056    0.046307
29       rs1372420    0.051416
30      rs11264302    0.057684
31      rs10831599    0.065901
32      rs12434297    0.068324
33       rs9985581    0.070506
34       rs6842271    0.077488
35      rs12935995    0.079672
36      rs11248057    0.080207
37       rs3806760    0.147021
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{Females}
\label{\detokenize{Cooper:females}}

\subsection{Logistic regression model}
\label{\detokenize{Cooper:id4}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{table1} \PYG{o}{=} \PYG{n}{table}\PYG{p}{[}\PYG{n}{table}\PYG{o}{.}\PYG{n}{gender} \PYG{o}{==} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{F}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}
\PYG{n}{X} \PYG{o}{=} \PYG{n}{table1}\PYG{p}{[}\PYG{n}{table1}\PYG{o}{.}\PYG{n}{columns}\PYG{p}{[}\PYG{l+m+mi}{5}\PYG{p}{:}\PYG{p}{]}\PYG{p}{]}
\PYG{n}{Y} \PYG{o}{=} \PYG{n}{table1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{phenotype}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{lr} \PYG{o}{=} \PYG{n}{LogisticRegression}\PYG{p}{(}\PYG{n}{random\PYGZus{}state}\PYG{o}{=}\PYG{l+m+mi}{42}\PYG{p}{,} \PYG{n}{solver}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{saga}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{n\PYGZus{}jobs}\PYG{o}{=}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{penalty}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{elasticnet}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{table1}\PYG{o}{.}\PYG{n}{groupby}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{phenotype}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{participant\PYGZus{}id}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{nunique}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
phenotype
0    567
1    567
Name: participant\PYGZus{}id, dtype: int64
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Grid search for 3 hyperparameters}
\label{\detokenize{Cooper:id5}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} parameters = \PYGZob{}\PYGZsq{}C\PYGZsq{}: [0.005, 0.01, 0.02, 0.05, 0.1, 0.5, 1, 10, 20, 30],}
\PYG{c+c1}{\PYGZsh{}              \PYGZsq{}max\PYGZus{}iter\PYGZsq{}: [10, 25, 50, 75, 100, 150, 200, 400, 800, 1600],}
\PYG{c+c1}{\PYGZsh{}              \PYGZsq{}l1\PYGZus{}ratio\PYGZsq{}: [1, 0.9, 0.8, 0.7, 0.6, 0.5, 0.4, 0.3, 0.2, 0.1]\PYGZcb{}}

\PYG{n}{parameters} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+m+mf}{0.005}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{]}\PYG{p}{,}
              \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{max\PYGZus{}iter}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+m+mi}{25}\PYG{p}{,} \PYG{l+m+mi}{50}\PYG{p}{,} \PYG{l+m+mi}{75}\PYG{p}{]}\PYG{p}{,}
              \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{l1\PYGZus{}ratio}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+m+mf}{0.1}\PYG{p}{,} \PYG{l+m+mf}{0.2}\PYG{p}{]}\PYG{p}{\PYGZcb{}}

\PYG{n}{grid\PYGZus{}lr} \PYG{o}{=} \PYG{n}{GridSearchCV}\PYG{p}{(}\PYG{n}{lr}\PYG{p}{,} \PYG{n}{parameters}\PYG{p}{,} \PYG{n}{verbose}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{,} \PYG{n}{scoring}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{roc\PYGZus{}auc}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{n\PYGZus{}jobs}\PYG{o}{=}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{cv}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{)}
\PYG{k}{if} \PYG{o+ow}{not} \PYG{n}{sys}\PYG{o}{.}\PYG{n}{warnoptions}\PYG{p}{:}
    \PYG{n}{warnings}\PYG{o}{.}\PYG{n}{simplefilter}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ignore}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{category}\PYG{o}{=}\PYG{n}{ConvergenceWarning}\PYG{p}{)}
    \PYG{n}{os}\PYG{o}{.}\PYG{n}{environ}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{PYTHONWARNINGS}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ignore}\PYG{l+s+s2}{\PYGZdq{}} \PYG{c+c1}{\PYGZsh{} Also affect subprocesses}
\PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{n}{X}\PYG{p}{,} \PYG{n}{Y}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
GridSearchCV(cv=10,
             estimator=LogisticRegression(n\PYGZus{}jobs=\PYGZhy{}1, penalty=\PYGZsq{}elasticnet\PYGZsq{},
                                          random\PYGZus{}state=42, solver=\PYGZsq{}saga\PYGZsq{}),
             n\PYGZus{}jobs=\PYGZhy{}1,
             param\PYGZus{}grid=\PYGZob{}\PYGZsq{}C\PYGZsq{}: [0.005, 0.01], \PYGZsq{}l1\PYGZus{}ratio\PYGZsq{}: [0.1, 0.2],
                         \PYGZsq{}max\PYGZus{}iter\PYGZsq{}: [25, 50, 75]\PYGZcb{},
             scoring=\PYGZsq{}roc\PYGZus{}auc\PYGZsq{}, verbose=False)
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Best estimator}
\label{\detokenize{Cooper:id6}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{best\PYGZus{}lr} \PYG{o}{=} \PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{best\PYGZus{}estimator\PYGZus{}}

\PYG{n}{max\PYGZus{}auc\PYGZus{}score} \PYG{o}{=} \PYG{n}{roc\PYGZus{}auc\PYGZus{}score}\PYG{p}{(}\PYG{n}{Y}\PYG{p}{,} \PYG{n}{best\PYGZus{}lr}\PYG{o}{.}\PYG{n}{predict\PYGZus{}proba}\PYG{p}{(}\PYG{n}{X}\PYG{p}{)}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{coefs} \PYG{o}{=} \PYG{n}{best\PYGZus{}lr}\PYG{o}{.}\PYG{n}{coef\PYGZus{}}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{p}{:}\PYG{p}{]}
\PYG{n}{num\PYGZus{}coef} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n}{coefs} \PYG{o}{!=} \PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{n}{X\PYGZus{}header} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{n}{X}\PYG{o}{.}\PYG{n}{columns}\PYG{p}{)}

\PYG{n}{data\PYGZus{}array} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{vstack}\PYG{p}{(}\PYG{p}{(}\PYG{n}{X\PYGZus{}header}\PYG{p}{,} \PYG{n}{coefs}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{model\PYGZus{}coefs} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n}{data}\PYG{o}{=}\PYG{n}{data\PYGZus{}array}\PYG{o}{.}\PYG{n}{T}\PYG{p}{,} \PYG{n}{columns}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{SNP}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Coefficient}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Max AUC score:}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{max\PYGZus{}auc\PYGZus{}score}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Non\PYGZhy{}zero coefficients: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{num\PYGZus{}coef}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Best estimator: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{best\PYGZus{}estimator\PYGZus{}}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Scorer: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{scorer\PYGZus{}}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Best params: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{best\PYGZus{}params\PYGZus{}}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Best score: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{best\PYGZus{}score\PYGZus{}}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{m} \PYG{o}{=} \PYG{n}{model\PYGZus{}coefs}\PYG{p}{[}\PYG{n}{model\PYGZus{}coefs}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Coefficient}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{!=} \PYG{l+m+mi}{0} \PYG{p}{]}\PYG{o}{.}\PYG{n}{sort\PYGZus{}values}\PYG{p}{(}\PYG{n}{by}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Coefficient}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{m} \PYG{o}{=} \PYG{n}{m}\PYG{o}{.}\PYG{n}{reset\PYGZus{}index}\PYG{p}{(}\PYG{n}{drop}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}\PYG{o}{.}\PYG{n}{assign}\PYG{p}{(}\PYG{n}{Index}\PYG{o}{=}\PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{m}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{m}\PYG{o}{.}\PYG{n}{Index}\PYG{o}{=} \PYG{n}{m}\PYG{o}{.}\PYG{n}{Index} \PYG{o}{+} \PYG{l+m+mi}{1}
\PYG{n}{m}\PYG{o}{.}\PYG{n}{set\PYGZus{}index}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Index}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Max AUC score:0.56756840825036

Non\PYGZhy{}zero coefficients: 6

Best estimator: LogisticRegression(C=0.005, l1\PYGZus{}ratio=0.1, max\PYGZus{}iter=50, n\PYGZus{}jobs=\PYGZhy{}1,
                   penalty=\PYGZsq{}elasticnet\PYGZsq{}, random\PYGZus{}state=42, solver=\PYGZsq{}saga\PYGZsq{})
Scorer: make\PYGZus{}scorer(roc\PYGZus{}auc\PYGZus{}score, needs\PYGZus{}threshold=True)
Best params: \PYGZob{}\PYGZsq{}C\PYGZsq{}: 0.005, \PYGZsq{}l1\PYGZus{}ratio\PYGZsq{}: 0.1, \PYGZsq{}max\PYGZus{}iter\PYGZsq{}: 50\PYGZcb{}
Best score: 0.5115738908675196
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
              SNP Coefficient
Index                        
1       rs6871718   \PYGZhy{}0.026889
2       rs1949362   \PYGZhy{}0.023602
3          rs6964    0.005616
4      rs11248057    0.005966
5       rs3850379    0.008878
6       rs3806760    0.016905
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{NN Males}
\label{\detokenize{Cooper:nn-males}}

\subsection{Logistic regression model}
\label{\detokenize{Cooper:id7}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{table1} \PYG{o}{=} \PYG{n}{table}\PYG{p}{[}\PYG{p}{(}\PYG{n}{table}\PYG{o}{.}\PYG{n}{gender} \PYG{o}{==} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{M}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)} \PYG{o}{\PYGZam{}} \PYG{p}{(}\PYG{n}{table}\PYG{o}{.}\PYG{n}{inv\PYGZus{}genotype}\PYG{o}{==}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{NN}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{]}
\PYG{n}{X} \PYG{o}{=} \PYG{n}{table1}\PYG{p}{[}\PYG{n}{table1}\PYG{o}{.}\PYG{n}{columns}\PYG{p}{[}\PYG{l+m+mi}{5}\PYG{p}{:}\PYG{p}{]}\PYG{p}{]}
\PYG{n}{Y} \PYG{o}{=} \PYG{n}{table1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{phenotype}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{lr} \PYG{o}{=} \PYG{n}{LogisticRegression}\PYG{p}{(}\PYG{n}{random\PYGZus{}state}\PYG{o}{=}\PYG{l+m+mi}{42}\PYG{p}{,} \PYG{n}{solver}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{saga}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{n\PYGZus{}jobs}\PYG{o}{=}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{penalty}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{elasticnet}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{table1}\PYG{o}{.}\PYG{n}{groupby}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{phenotype}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{participant\PYGZus{}id}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{nunique}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
phenotype
0    191
1    216
Name: participant\PYGZus{}id, dtype: int64
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Grid search for 3 hyperparameters}
\label{\detokenize{Cooper:id8}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} parameters = \PYGZob{}\PYGZsq{}C\PYGZsq{}: [0.005, 0.01, 0.02, 0.05, 0.1, 0.5, 1, 10, 20, 30],}
\PYG{c+c1}{\PYGZsh{}               \PYGZsq{}max\PYGZus{}iter\PYGZsq{}: [10, 25, 50, 75, 100, 150, 200, 400, 800, 1600],}
\PYG{c+c1}{\PYGZsh{}               \PYGZsq{}l1\PYGZus{}ratio\PYGZsq{}: [1, 0.9, 0.8, 0.7, 0.6, 0.5, 0.4, 0.3, 0.2, 0.1]\PYGZcb{}}

\PYG{n}{parameters} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+m+mf}{0.05}\PYG{p}{,} \PYG{l+m+mf}{0.1}\PYG{p}{,} \PYG{l+m+mf}{0.5}\PYG{p}{]}\PYG{p}{,}
              \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{max\PYGZus{}iter}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{l+m+mi}{25}\PYG{p}{]}\PYG{p}{,}
              \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{l1\PYGZus{}ratio}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+m+mf}{0.7}\PYG{p}{,} \PYG{l+m+mf}{0.6}\PYG{p}{,} \PYG{l+m+mf}{0.5}\PYG{p}{]}\PYG{p}{\PYGZcb{}}

\PYG{n}{grid\PYGZus{}lr} \PYG{o}{=} \PYG{n}{GridSearchCV}\PYG{p}{(}\PYG{n}{lr}\PYG{p}{,} \PYG{n}{parameters}\PYG{p}{,} \PYG{n}{verbose}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{,} \PYG{n}{scoring}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{roc\PYGZus{}auc}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{n\PYGZus{}jobs}\PYG{o}{=}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{cv}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{)}
\PYG{k}{if} \PYG{o+ow}{not} \PYG{n}{sys}\PYG{o}{.}\PYG{n}{warnoptions}\PYG{p}{:}
    \PYG{n}{warnings}\PYG{o}{.}\PYG{n}{simplefilter}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ignore}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{category}\PYG{o}{=}\PYG{n}{ConvergenceWarning}\PYG{p}{)}
    \PYG{n}{os}\PYG{o}{.}\PYG{n}{environ}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{PYTHONWARNINGS}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ignore}\PYG{l+s+s2}{\PYGZdq{}} \PYG{c+c1}{\PYGZsh{} Also affect subprocesses}
\PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{n}{X}\PYG{p}{,} \PYG{n}{Y}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
GridSearchCV(cv=10,
             estimator=LogisticRegression(n\PYGZus{}jobs=\PYGZhy{}1, penalty=\PYGZsq{}elasticnet\PYGZsq{},
                                          random\PYGZus{}state=42, solver=\PYGZsq{}saga\PYGZsq{}),
             n\PYGZus{}jobs=\PYGZhy{}1,
             param\PYGZus{}grid=\PYGZob{}\PYGZsq{}C\PYGZsq{}: [0.05, 0.1, 0.5], \PYGZsq{}l1\PYGZus{}ratio\PYGZsq{}: [0.7, 0.6, 0.5],
                         \PYGZsq{}max\PYGZus{}iter\PYGZsq{}: [10, 25]\PYGZcb{},
             scoring=\PYGZsq{}roc\PYGZus{}auc\PYGZsq{}, verbose=False)
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Best estimator}
\label{\detokenize{Cooper:id9}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{best\PYGZus{}lr} \PYG{o}{=} \PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{best\PYGZus{}estimator\PYGZus{}}

\PYG{n}{max\PYGZus{}auc\PYGZus{}score} \PYG{o}{=} \PYG{n}{roc\PYGZus{}auc\PYGZus{}score}\PYG{p}{(}\PYG{n}{Y}\PYG{p}{,} \PYG{n}{best\PYGZus{}lr}\PYG{o}{.}\PYG{n}{predict\PYGZus{}proba}\PYG{p}{(}\PYG{n}{X}\PYG{p}{)}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{coefs} \PYG{o}{=} \PYG{n}{best\PYGZus{}lr}\PYG{o}{.}\PYG{n}{coef\PYGZus{}}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{p}{:}\PYG{p}{]}
\PYG{n}{num\PYGZus{}coef} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n}{coefs} \PYG{o}{!=} \PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{n}{X\PYGZus{}header} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{n}{X}\PYG{o}{.}\PYG{n}{columns}\PYG{p}{)}

\PYG{n}{data\PYGZus{}array} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{vstack}\PYG{p}{(}\PYG{p}{(}\PYG{n}{X\PYGZus{}header}\PYG{p}{,} \PYG{n}{coefs}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{model\PYGZus{}coefs} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n}{data}\PYG{o}{=}\PYG{n}{data\PYGZus{}array}\PYG{o}{.}\PYG{n}{T}\PYG{p}{,} \PYG{n}{columns}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{SNP}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Coefficient}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Max AUC score:}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{max\PYGZus{}auc\PYGZus{}score}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Non\PYGZhy{}zero coefficients: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{num\PYGZus{}coef}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Best estimator: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{best\PYGZus{}estimator\PYGZus{}}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Scorer: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{scorer\PYGZus{}}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Best params: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{best\PYGZus{}params\PYGZus{}}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Best score: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{best\PYGZus{}score\PYGZus{}}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{m} \PYG{o}{=} \PYG{n}{model\PYGZus{}coefs}\PYG{p}{[}\PYG{n}{model\PYGZus{}coefs}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Coefficient}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{!=} \PYG{l+m+mi}{0} \PYG{p}{]}\PYG{o}{.}\PYG{n}{sort\PYGZus{}values}\PYG{p}{(}\PYG{n}{by}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Coefficient}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{m} \PYG{o}{=} \PYG{n}{m}\PYG{o}{.}\PYG{n}{reset\PYGZus{}index}\PYG{p}{(}\PYG{n}{drop}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}\PYG{o}{.}\PYG{n}{assign}\PYG{p}{(}\PYG{n}{Index}\PYG{o}{=}\PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{m}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{m}\PYG{o}{.}\PYG{n}{Index}\PYG{o}{=} \PYG{n}{m}\PYG{o}{.}\PYG{n}{Index} \PYG{o}{+} \PYG{l+m+mi}{1}
\PYG{n}{m}\PYG{o}{.}\PYG{n}{set\PYGZus{}index}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Index}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Max AUC score:0.7224403723094822

Non\PYGZhy{}zero coefficients: 32

Best estimator: LogisticRegression(C=0.1, l1\PYGZus{}ratio=0.6, max\PYGZus{}iter=10, n\PYGZus{}jobs=\PYGZhy{}1,
                   penalty=\PYGZsq{}elasticnet\PYGZsq{}, random\PYGZus{}state=42, solver=\PYGZsq{}saga\PYGZsq{})
Scorer: make\PYGZus{}scorer(roc\PYGZus{}auc\PYGZus{}score, needs\PYGZus{}threshold=True)
Best params: \PYGZob{}\PYGZsq{}C\PYGZsq{}: 0.1, \PYGZsq{}l1\PYGZus{}ratio\PYGZsq{}: 0.6, \PYGZsq{}max\PYGZus{}iter\PYGZsq{}: 10\PYGZcb{}
Best score: 0.5580189109136477
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                SNP Coefficient
Index                          
1        rs35776335   \PYGZhy{}0.213769
2        rs13161496   \PYGZhy{}0.193039
3        rs12499663   \PYGZhy{}0.150666
4          rs444618   \PYGZhy{}0.124434
5       rs112270735   \PYGZhy{}0.083023
6      rs1269243287   \PYGZhy{}0.055458
7         rs3912643   \PYGZhy{}0.048141
8        rs11097297   \PYGZhy{}0.047875
9         rs2128786    \PYGZhy{}0.03413
10        rs3850379   \PYGZhy{}0.030484
11        rs4331494   \PYGZhy{}0.014515
12       rs11264302   \PYGZhy{}0.001455
13        rs3850745   \PYGZhy{}0.001154
14       rs35456861   \PYGZhy{}0.000152
15         rs764324   \PYGZhy{}0.000024
16       rs12543164    0.000034
17       rs10448130    0.000146
18       rs35933728    0.000247
19        rs2412116    0.018849
20       rs79828056    0.022762
21        rs1949362    0.027434
22        rs1501467    0.035676
23       rs78197677     0.05128
24        rs1372420    0.073048
25        rs6842271    0.088079
26       rs12434297    0.089281
27        rs9985581    0.124415
28        rs3822023    0.128854
29       rs55805734    0.133538
30        rs4897753    0.210087
31           rs6964    0.215979
32        rs3806760    0.233441
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{NI Males}
\label{\detokenize{Cooper:ni-males}}

\subsection{Logistic regression model}
\label{\detokenize{Cooper:id10}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{table1} \PYG{o}{=} \PYG{n}{table}\PYG{p}{[}\PYG{p}{(}\PYG{n}{table}\PYG{o}{.}\PYG{n}{gender} \PYG{o}{==} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{M}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)} \PYG{o}{\PYGZam{}} \PYG{p}{(}\PYG{n}{table}\PYG{o}{.}\PYG{n}{inv\PYGZus{}genotype}\PYG{o}{==}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{NI}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{]}
\PYG{n}{X} \PYG{o}{=} \PYG{n}{table1}\PYG{p}{[}\PYG{n}{table1}\PYG{o}{.}\PYG{n}{columns}\PYG{p}{[}\PYG{l+m+mi}{5}\PYG{p}{:}\PYG{p}{]}\PYG{p}{]}
\PYG{n}{Y} \PYG{o}{=} \PYG{n}{table1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{phenotype}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{lr} \PYG{o}{=} \PYG{n}{LogisticRegression}\PYG{p}{(}\PYG{n}{random\PYGZus{}state}\PYG{o}{=}\PYG{l+m+mi}{42}\PYG{p}{,} \PYG{n}{solver}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{saga}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{n\PYGZus{}jobs}\PYG{o}{=}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{penalty}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{elasticnet}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{table1}\PYG{o}{.}\PYG{n}{groupby}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{phenotype}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{participant\PYGZus{}id}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{nunique}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
phenotype
0    480
1    477
Name: participant\PYGZus{}id, dtype: int64
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Grid search for 3 hyperparameters}
\label{\detokenize{Cooper:id11}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} parameters = \PYGZob{}\PYGZsq{}C\PYGZsq{}: [0.005, 0.01, 0.02, 0.05, 0.1, 0.5, 1, 10, 20, 30],}
\PYG{c+c1}{\PYGZsh{}               \PYGZsq{}max\PYGZus{}iter\PYGZsq{}: [10, 25, 50, 75, 100, 150, 200, 400, 800, 1600],}
\PYG{c+c1}{\PYGZsh{}               \PYGZsq{}l1\PYGZus{}ratio\PYGZsq{}: [1, 0.9, 0.8, 0.7, 0.6, 0.5, 0.4, 0.3, 0.2, 0.1]\PYGZcb{}}

\PYG{n}{parameters} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+m+mf}{0.005}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{]}\PYG{p}{,}
              \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{max\PYGZus{}iter}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{l+m+mi}{25}\PYG{p}{,} \PYG{l+m+mi}{50}\PYG{p}{]}\PYG{p}{,}
              \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{l1\PYGZus{}ratio}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+m+mf}{0.2}\PYG{p}{,} \PYG{l+m+mf}{0.1}\PYG{p}{]}\PYG{p}{\PYGZcb{}}

\PYG{n}{grid\PYGZus{}lr} \PYG{o}{=} \PYG{n}{GridSearchCV}\PYG{p}{(}\PYG{n}{lr}\PYG{p}{,} \PYG{n}{parameters}\PYG{p}{,} \PYG{n}{verbose}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{,} \PYG{n}{scoring}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{roc\PYGZus{}auc}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{n\PYGZus{}jobs}\PYG{o}{=}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{cv}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{)}
\PYG{k}{if} \PYG{o+ow}{not} \PYG{n}{sys}\PYG{o}{.}\PYG{n}{warnoptions}\PYG{p}{:}
    \PYG{n}{warnings}\PYG{o}{.}\PYG{n}{simplefilter}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ignore}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{category}\PYG{o}{=}\PYG{n}{ConvergenceWarning}\PYG{p}{)}
    \PYG{n}{os}\PYG{o}{.}\PYG{n}{environ}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{PYTHONWARNINGS}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ignore}\PYG{l+s+s2}{\PYGZdq{}} \PYG{c+c1}{\PYGZsh{} Also affect subprocesses}
\PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{n}{X}\PYG{p}{,} \PYG{n}{Y}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
GridSearchCV(cv=10,
             estimator=LogisticRegression(n\PYGZus{}jobs=\PYGZhy{}1, penalty=\PYGZsq{}elasticnet\PYGZsq{},
                                          random\PYGZus{}state=42, solver=\PYGZsq{}saga\PYGZsq{}),
             n\PYGZus{}jobs=\PYGZhy{}1,
             param\PYGZus{}grid=\PYGZob{}\PYGZsq{}C\PYGZsq{}: [0.005, 0.01], \PYGZsq{}l1\PYGZus{}ratio\PYGZsq{}: [0.2, 0.1],
                         \PYGZsq{}max\PYGZus{}iter\PYGZsq{}: [10, 25, 50]\PYGZcb{},
             scoring=\PYGZsq{}roc\PYGZus{}auc\PYGZsq{}, verbose=False)
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Best estimator}
\label{\detokenize{Cooper:id12}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{best\PYGZus{}lr} \PYG{o}{=} \PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{best\PYGZus{}estimator\PYGZus{}}

\PYG{n}{max\PYGZus{}auc\PYGZus{}score} \PYG{o}{=} \PYG{n}{roc\PYGZus{}auc\PYGZus{}score}\PYG{p}{(}\PYG{n}{Y}\PYG{p}{,} \PYG{n}{best\PYGZus{}lr}\PYG{o}{.}\PYG{n}{predict\PYGZus{}proba}\PYG{p}{(}\PYG{n}{X}\PYG{p}{)}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{coefs} \PYG{o}{=} \PYG{n}{best\PYGZus{}lr}\PYG{o}{.}\PYG{n}{coef\PYGZus{}}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{p}{:}\PYG{p}{]}
\PYG{n}{num\PYGZus{}coef} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n}{coefs} \PYG{o}{!=} \PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{n}{X\PYGZus{}header} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{n}{X}\PYG{o}{.}\PYG{n}{columns}\PYG{p}{)}

\PYG{n}{data\PYGZus{}array} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{vstack}\PYG{p}{(}\PYG{p}{(}\PYG{n}{X\PYGZus{}header}\PYG{p}{,} \PYG{n}{coefs}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{model\PYGZus{}coefs} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n}{data}\PYG{o}{=}\PYG{n}{data\PYGZus{}array}\PYG{o}{.}\PYG{n}{T}\PYG{p}{,} \PYG{n}{columns}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{SNP}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Coefficient}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Max AUC score:}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{max\PYGZus{}auc\PYGZus{}score}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Non\PYGZhy{}zero coefficients: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{num\PYGZus{}coef}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Best estimator: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{best\PYGZus{}estimator\PYGZus{}}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Scorer: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{scorer\PYGZus{}}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Best params: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{best\PYGZus{}params\PYGZus{}}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Best score: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{best\PYGZus{}score\PYGZus{}}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{m} \PYG{o}{=} \PYG{n}{model\PYGZus{}coefs}\PYG{p}{[}\PYG{n}{model\PYGZus{}coefs}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Coefficient}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{!=} \PYG{l+m+mi}{0} \PYG{p}{]}\PYG{o}{.}\PYG{n}{sort\PYGZus{}values}\PYG{p}{(}\PYG{n}{by}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Coefficient}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{m} \PYG{o}{=} \PYG{n}{m}\PYG{o}{.}\PYG{n}{reset\PYGZus{}index}\PYG{p}{(}\PYG{n}{drop}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}\PYG{o}{.}\PYG{n}{assign}\PYG{p}{(}\PYG{n}{Index}\PYG{o}{=}\PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{m}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{m}\PYG{o}{.}\PYG{n}{Index}\PYG{o}{=} \PYG{n}{m}\PYG{o}{.}\PYG{n}{Index} \PYG{o}{+} \PYG{l+m+mi}{1}
\PYG{n}{m}\PYG{o}{.}\PYG{n}{set\PYGZus{}index}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Index}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Max AUC score:0.5835888364779874

Non\PYGZhy{}zero coefficients: 4

Best estimator: LogisticRegression(C=0.005, l1\PYGZus{}ratio=0.1, max\PYGZus{}iter=25, n\PYGZus{}jobs=\PYGZhy{}1,
                   penalty=\PYGZsq{}elasticnet\PYGZsq{}, random\PYGZus{}state=42, solver=\PYGZsq{}saga\PYGZsq{})
Scorer: make\PYGZus{}scorer(roc\PYGZus{}auc\PYGZus{}score, needs\PYGZus{}threshold=True)
Best params: \PYGZob{}\PYGZsq{}C\PYGZsq{}: 0.005, \PYGZsq{}l1\PYGZus{}ratio\PYGZsq{}: 0.1, \PYGZsq{}max\PYGZus{}iter\PYGZsq{}: 25\PYGZcb{}
Best score: 0.5212733636229314
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
             SNP Coefficient
Index                       
1      rs7520918   \PYGZhy{}0.011899
2      rs9985581    0.016555
3      rs6842271    0.016555
4      rs3806760    0.027075
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{II Males}
\label{\detokenize{Cooper:ii-males}}

\subsection{Logistic regression model}
\label{\detokenize{Cooper:id13}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{table1} \PYG{o}{=} \PYG{n}{table}\PYG{p}{[}\PYG{p}{(}\PYG{n}{table}\PYG{o}{.}\PYG{n}{gender} \PYG{o}{==} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{M}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)} \PYG{o}{\PYGZam{}} \PYG{p}{(}\PYG{n}{table}\PYG{o}{.}\PYG{n}{inv\PYGZus{}genotype}\PYG{o}{==}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{II}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{]}
\PYG{n}{X} \PYG{o}{=} \PYG{n}{table1}\PYG{p}{[}\PYG{n}{table1}\PYG{o}{.}\PYG{n}{columns}\PYG{p}{[}\PYG{l+m+mi}{5}\PYG{p}{:}\PYG{p}{]}\PYG{p}{]}
\PYG{n}{Y} \PYG{o}{=} \PYG{n}{table1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{phenotype}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{lr} \PYG{o}{=} \PYG{n}{LogisticRegression}\PYG{p}{(}\PYG{n}{random\PYGZus{}state}\PYG{o}{=}\PYG{l+m+mi}{42}\PYG{p}{,} \PYG{n}{solver}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{saga}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{n\PYGZus{}jobs}\PYG{o}{=}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{penalty}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{elasticnet}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{table1}\PYG{o}{.}\PYG{n}{groupby}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{phenotype}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{participant\PYGZus{}id}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{nunique}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
phenotype
0    318
1    296
Name: participant\PYGZus{}id, dtype: int64
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Grid search for 3 hyperparameters}
\label{\detokenize{Cooper:id14}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} parameters = \PYGZob{}\PYGZsq{}C\PYGZsq{}: [0.005, 0.01, 0.02, 0.05, 0.1, 0.5, 1, 10, 20, 30],}
\PYG{c+c1}{\PYGZsh{}               \PYGZsq{}max\PYGZus{}iter\PYGZsq{}: [10, 25, 50, 75, 100, 150, 200, 400, 800, 1600],}
\PYG{c+c1}{\PYGZsh{}               \PYGZsq{}l1\PYGZus{}ratio\PYGZsq{}: [1, 0.9, 0.8, 0.7, 0.6, 0.5, 0.4, 0.3, 0.2, 0.1]\PYGZcb{}}

\PYG{n}{parameters} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+m+mf}{0.01}\PYG{p}{,} \PYG{l+m+mf}{0.02}\PYG{p}{]}\PYG{p}{,}
              \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{max\PYGZus{}iter}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+m+mi}{50}\PYG{p}{,} \PYG{l+m+mi}{75}\PYG{p}{,} \PYG{l+m+mi}{100}\PYG{p}{]}\PYG{p}{,}
              \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{l1\PYGZus{}ratio}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+m+mf}{0.2}\PYG{p}{,} \PYG{l+m+mf}{0.1}\PYG{p}{]}\PYG{p}{\PYGZcb{}}

\PYG{n}{grid\PYGZus{}lr} \PYG{o}{=} \PYG{n}{GridSearchCV}\PYG{p}{(}\PYG{n}{lr}\PYG{p}{,} \PYG{n}{parameters}\PYG{p}{,} \PYG{n}{verbose}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{,} \PYG{n}{scoring}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{roc\PYGZus{}auc}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{n\PYGZus{}jobs}\PYG{o}{=}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{cv}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{)}
\PYG{k}{if} \PYG{o+ow}{not} \PYG{n}{sys}\PYG{o}{.}\PYG{n}{warnoptions}\PYG{p}{:}
    \PYG{n}{warnings}\PYG{o}{.}\PYG{n}{simplefilter}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ignore}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{category}\PYG{o}{=}\PYG{n}{ConvergenceWarning}\PYG{p}{)}
    \PYG{n}{os}\PYG{o}{.}\PYG{n}{environ}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{PYTHONWARNINGS}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ignore}\PYG{l+s+s2}{\PYGZdq{}} \PYG{c+c1}{\PYGZsh{} Also affect subprocesses}
\PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{n}{X}\PYG{p}{,} \PYG{n}{Y}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
GridSearchCV(cv=10,
             estimator=LogisticRegression(n\PYGZus{}jobs=\PYGZhy{}1, penalty=\PYGZsq{}elasticnet\PYGZsq{},
                                          random\PYGZus{}state=42, solver=\PYGZsq{}saga\PYGZsq{}),
             n\PYGZus{}jobs=\PYGZhy{}1,
             param\PYGZus{}grid=\PYGZob{}\PYGZsq{}C\PYGZsq{}: [0.01, 0.02], \PYGZsq{}l1\PYGZus{}ratio\PYGZsq{}: [0.2, 0.1],
                         \PYGZsq{}max\PYGZus{}iter\PYGZsq{}: [50, 75, 100]\PYGZcb{},
             scoring=\PYGZsq{}roc\PYGZus{}auc\PYGZsq{}, verbose=False)
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Best estimator}
\label{\detokenize{Cooper:id15}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{best\PYGZus{}lr} \PYG{o}{=} \PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{best\PYGZus{}estimator\PYGZus{}}

\PYG{n}{max\PYGZus{}auc\PYGZus{}score} \PYG{o}{=} \PYG{n}{roc\PYGZus{}auc\PYGZus{}score}\PYG{p}{(}\PYG{n}{Y}\PYG{p}{,} \PYG{n}{best\PYGZus{}lr}\PYG{o}{.}\PYG{n}{predict\PYGZus{}proba}\PYG{p}{(}\PYG{n}{X}\PYG{p}{)}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{coefs} \PYG{o}{=} \PYG{n}{best\PYGZus{}lr}\PYG{o}{.}\PYG{n}{coef\PYGZus{}}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{p}{:}\PYG{p}{]}
\PYG{n}{num\PYGZus{}coef} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n}{coefs} \PYG{o}{!=} \PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{n}{X\PYGZus{}header} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{n}{X}\PYG{o}{.}\PYG{n}{columns}\PYG{p}{)}

\PYG{n}{data\PYGZus{}array} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{vstack}\PYG{p}{(}\PYG{p}{(}\PYG{n}{X\PYGZus{}header}\PYG{p}{,} \PYG{n}{coefs}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{model\PYGZus{}coefs} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n}{data}\PYG{o}{=}\PYG{n}{data\PYGZus{}array}\PYG{o}{.}\PYG{n}{T}\PYG{p}{,} \PYG{n}{columns}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{SNP}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Coefficient}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Max AUC score:}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{max\PYGZus{}auc\PYGZus{}score}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Non\PYGZhy{}zero coefficients: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{num\PYGZus{}coef}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Best estimator: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{best\PYGZus{}estimator\PYGZus{}}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Scorer: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{scorer\PYGZus{}}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Best params: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{best\PYGZus{}params\PYGZus{}}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Best score: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{best\PYGZus{}score\PYGZus{}}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{m} \PYG{o}{=} \PYG{n}{model\PYGZus{}coefs}\PYG{p}{[}\PYG{n}{model\PYGZus{}coefs}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Coefficient}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{!=} \PYG{l+m+mi}{0} \PYG{p}{]}\PYG{o}{.}\PYG{n}{sort\PYGZus{}values}\PYG{p}{(}\PYG{n}{by}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Coefficient}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{m} \PYG{o}{=} \PYG{n}{m}\PYG{o}{.}\PYG{n}{reset\PYGZus{}index}\PYG{p}{(}\PYG{n}{drop}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}\PYG{o}{.}\PYG{n}{assign}\PYG{p}{(}\PYG{n}{Index}\PYG{o}{=}\PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{m}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{m}\PYG{o}{.}\PYG{n}{Index}\PYG{o}{=} \PYG{n}{m}\PYG{o}{.}\PYG{n}{Index} \PYG{o}{+} \PYG{l+m+mi}{1}
\PYG{n}{m}\PYG{o}{.}\PYG{n}{set\PYGZus{}index}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Index}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Max AUC score:0.6759093999660037

Non\PYGZhy{}zero coefficients: 18

Best estimator: LogisticRegression(C=0.01, l1\PYGZus{}ratio=0.1, max\PYGZus{}iter=75, n\PYGZus{}jobs=\PYGZhy{}1,
                   penalty=\PYGZsq{}elasticnet\PYGZsq{}, random\PYGZus{}state=42, solver=\PYGZsq{}saga\PYGZsq{})
Scorer: make\PYGZus{}scorer(roc\PYGZus{}auc\PYGZus{}score, needs\PYGZus{}threshold=True)
Best params: \PYGZob{}\PYGZsq{}C\PYGZsq{}: 0.01, \PYGZsq{}l1\PYGZus{}ratio\PYGZsq{}: 0.1, \PYGZsq{}max\PYGZus{}iter\PYGZsq{}: 75\PYGZcb{}
Best score: 0.6007288190582128
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
               SNP Coefficient
Index                         
1          rs34333   \PYGZhy{}0.092096
2        rs3733349   \PYGZhy{}0.053093
3        rs3785891   \PYGZhy{}0.013793
4        rs8064765   \PYGZhy{}0.003056
5       rs62075803   \PYGZhy{}0.002828
6        rs4796663   \PYGZhy{}0.002828
7        rs4028634    0.001729
8        rs2410595    0.003947
9         rs764324     0.00623
10       rs4482120    0.009129
11     rs112318363    0.037641
12      rs12935995    0.040157
13      rs11097213    0.049525
14       rs3806760    0.050662
15      rs11248057    0.078256
16      rs11264302     0.08048
17          rs5848    0.085027
18      rs12434297    0.085108
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{NN Females}
\label{\detokenize{Cooper:nn-females}}

\subsection{Logistic regression model}
\label{\detokenize{Cooper:id16}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{table1} \PYG{o}{=} \PYG{n}{table}\PYG{p}{[}\PYG{p}{(}\PYG{n}{table}\PYG{o}{.}\PYG{n}{gender} \PYG{o}{==} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{F}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)} \PYG{o}{\PYGZam{}} \PYG{p}{(}\PYG{n}{table}\PYG{o}{.}\PYG{n}{inv\PYGZus{}genotype}\PYG{o}{==}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{NN}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{]}
\PYG{n}{X} \PYG{o}{=} \PYG{n}{table1}\PYG{p}{[}\PYG{n}{table1}\PYG{o}{.}\PYG{n}{columns}\PYG{p}{[}\PYG{l+m+mi}{5}\PYG{p}{:}\PYG{p}{]}\PYG{p}{]}
\PYG{n}{Y} \PYG{o}{=} \PYG{n}{table1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{phenotype}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{lr} \PYG{o}{=} \PYG{n}{LogisticRegression}\PYG{p}{(}\PYG{n}{random\PYGZus{}state}\PYG{o}{=}\PYG{l+m+mi}{42}\PYG{p}{,} \PYG{n}{solver}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{saga}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{n\PYGZus{}jobs}\PYG{o}{=}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{penalty}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{elasticnet}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{table1}\PYG{o}{.}\PYG{n}{groupby}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{phenotype}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{participant\PYGZus{}id}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{nunique}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
phenotype
0    113
1    122
Name: participant\PYGZus{}id, dtype: int64
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Grid search for 3 hyperparameters}
\label{\detokenize{Cooper:id17}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} parameters = \PYGZob{}\PYGZsq{}C\PYGZsq{}: [0.005, 0.01, 0.02, 0.05, 0.1, 0.5, 1, 10, 20, 30],}
\PYG{c+c1}{\PYGZsh{}               \PYGZsq{}max\PYGZus{}iter\PYGZsq{}: [10, 25, 50, 75, 100, 150, 200, 400, 800, 1600],}
\PYG{c+c1}{\PYGZsh{}               \PYGZsq{}l1\PYGZus{}ratio\PYGZsq{}: [1, 0.9, 0.8, 0.7, 0.6, 0.5, 0.4, 0.3, 0.2, 0.1]\PYGZcb{}}

\PYG{n}{parameters} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+m+mf}{0.1}\PYG{p}{,} \PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,}
              \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{max\PYGZus{}iter}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{l+m+mi}{25}\PYG{p}{]}\PYG{p}{,}
              \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{l1\PYGZus{}ratio}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+m+mf}{0.7}\PYG{p}{,} \PYG{l+m+mf}{0.6}\PYG{p}{,} \PYG{l+m+mf}{0.5}\PYG{p}{]}\PYG{p}{\PYGZcb{}}

\PYG{n}{grid\PYGZus{}lr} \PYG{o}{=} \PYG{n}{GridSearchCV}\PYG{p}{(}\PYG{n}{lr}\PYG{p}{,} \PYG{n}{parameters}\PYG{p}{,} \PYG{n}{verbose}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{,} \PYG{n}{scoring}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{roc\PYGZus{}auc}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{n\PYGZus{}jobs}\PYG{o}{=}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{cv}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{)}
\PYG{k}{if} \PYG{o+ow}{not} \PYG{n}{sys}\PYG{o}{.}\PYG{n}{warnoptions}\PYG{p}{:}
    \PYG{n}{warnings}\PYG{o}{.}\PYG{n}{simplefilter}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ignore}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{category}\PYG{o}{=}\PYG{n}{ConvergenceWarning}\PYG{p}{)}
    \PYG{n}{os}\PYG{o}{.}\PYG{n}{environ}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{PYTHONWARNINGS}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ignore}\PYG{l+s+s2}{\PYGZdq{}} \PYG{c+c1}{\PYGZsh{} Also affect subprocesses}
\PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{n}{X}\PYG{p}{,} \PYG{n}{Y}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
GridSearchCV(cv=10,
             estimator=LogisticRegression(n\PYGZus{}jobs=\PYGZhy{}1, penalty=\PYGZsq{}elasticnet\PYGZsq{},
                                          random\PYGZus{}state=42, solver=\PYGZsq{}saga\PYGZsq{}),
             n\PYGZus{}jobs=\PYGZhy{}1,
             param\PYGZus{}grid=\PYGZob{}\PYGZsq{}C\PYGZsq{}: [0.1, 0.5, 1], \PYGZsq{}l1\PYGZus{}ratio\PYGZsq{}: [0.7, 0.6, 0.5],
                         \PYGZsq{}max\PYGZus{}iter\PYGZsq{}: [10, 25]\PYGZcb{},
             scoring=\PYGZsq{}roc\PYGZus{}auc\PYGZsq{}, verbose=False)
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Best estimator}
\label{\detokenize{Cooper:id18}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{best\PYGZus{}lr} \PYG{o}{=} \PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{best\PYGZus{}estimator\PYGZus{}}

\PYG{n}{max\PYGZus{}auc\PYGZus{}score} \PYG{o}{=} \PYG{n}{roc\PYGZus{}auc\PYGZus{}score}\PYG{p}{(}\PYG{n}{Y}\PYG{p}{,} \PYG{n}{best\PYGZus{}lr}\PYG{o}{.}\PYG{n}{predict\PYGZus{}proba}\PYG{p}{(}\PYG{n}{X}\PYG{p}{)}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{coefs} \PYG{o}{=} \PYG{n}{best\PYGZus{}lr}\PYG{o}{.}\PYG{n}{coef\PYGZus{}}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{p}{:}\PYG{p}{]}
\PYG{n}{num\PYGZus{}coef} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n}{coefs} \PYG{o}{!=} \PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{n}{X\PYGZus{}header} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{n}{X}\PYG{o}{.}\PYG{n}{columns}\PYG{p}{)}

\PYG{n}{data\PYGZus{}array} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{vstack}\PYG{p}{(}\PYG{p}{(}\PYG{n}{X\PYGZus{}header}\PYG{p}{,} \PYG{n}{coefs}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{model\PYGZus{}coefs} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n}{data}\PYG{o}{=}\PYG{n}{data\PYGZus{}array}\PYG{o}{.}\PYG{n}{T}\PYG{p}{,} \PYG{n}{columns}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{SNP}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Coefficient}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Max AUC score:}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{max\PYGZus{}auc\PYGZus{}score}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Non\PYGZhy{}zero coefficients: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{num\PYGZus{}coef}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Best estimator: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{best\PYGZus{}estimator\PYGZus{}}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Scorer: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{scorer\PYGZus{}}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Best params: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{best\PYGZus{}params\PYGZus{}}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Best score: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{best\PYGZus{}score\PYGZus{}}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{m} \PYG{o}{=} \PYG{n}{model\PYGZus{}coefs}\PYG{p}{[}\PYG{n}{model\PYGZus{}coefs}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Coefficient}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{!=} \PYG{l+m+mi}{0} \PYG{p}{]}\PYG{o}{.}\PYG{n}{sort\PYGZus{}values}\PYG{p}{(}\PYG{n}{by}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Coefficient}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{m} \PYG{o}{=} \PYG{n}{m}\PYG{o}{.}\PYG{n}{reset\PYGZus{}index}\PYG{p}{(}\PYG{n}{drop}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}\PYG{o}{.}\PYG{n}{assign}\PYG{p}{(}\PYG{n}{Index}\PYG{o}{=}\PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{m}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{m}\PYG{o}{.}\PYG{n}{Index}\PYG{o}{=} \PYG{n}{m}\PYG{o}{.}\PYG{n}{Index} \PYG{o}{+} \PYG{l+m+mi}{1}
\PYG{n}{m}\PYG{o}{.}\PYG{n}{set\PYGZus{}index}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Index}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Max AUC score:0.8581894675758015

Non\PYGZhy{}zero coefficients: 112

Best estimator: LogisticRegression(C=0.5, l1\PYGZus{}ratio=0.6, max\PYGZus{}iter=10, n\PYGZus{}jobs=\PYGZhy{}1,
                   penalty=\PYGZsq{}elasticnet\PYGZsq{}, random\PYGZus{}state=42, solver=\PYGZsq{}saga\PYGZsq{})
Scorer: make\PYGZus{}scorer(roc\PYGZus{}auc\PYGZus{}score, needs\PYGZus{}threshold=True)
Best params: \PYGZob{}\PYGZsq{}C\PYGZsq{}: 0.5, \PYGZsq{}l1\PYGZus{}ratio\PYGZsq{}: 0.6, \PYGZsq{}max\PYGZus{}iter\PYGZsq{}: 10\PYGZcb{}
Best score: 0.5679924242424242
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                SNP Coefficient
Index                          
1         rs6871718   \PYGZhy{}0.426813
2          rs999361   \PYGZhy{}0.426221
3         rs7826007   \PYGZhy{}0.365302
4         rs3733349   \PYGZhy{}0.346928
5        rs78197677   \PYGZhy{}0.284285
6         rs7535292    \PYGZhy{}0.26294
7         rs4859611   \PYGZhy{}0.257429
8         rs1949362   \PYGZhy{}0.254682
9        rs11601088   \PYGZhy{}0.247447
10        rs7515378   \PYGZhy{}0.221912
11       rs12101192   \PYGZhy{}0.193561
12         rs231454   \PYGZhy{}0.182738
13        rs1859223   \PYGZhy{}0.170208
14       rs79976845   \PYGZhy{}0.159289
15        rs4495967   \PYGZhy{}0.150381
16        rs4482120   \PYGZhy{}0.150381
17        rs1501467   \PYGZhy{}0.140416
18       rs79828056   \PYGZhy{}0.136308
19        rs2433733    \PYGZhy{}0.12592
20        rs1372420   \PYGZhy{}0.125209
21       rs41311559   \PYGZhy{}0.114078
22      rs140859835   \PYGZhy{}0.084564
23       rs11097297   \PYGZhy{}0.083788
24       rs11097213   \PYGZhy{}0.076345
25        rs3822023   \PYGZhy{}0.074309
26      rs142448570   \PYGZhy{}0.073881
27       rs10448130   \PYGZhy{}0.073017
28       rs76848738   \PYGZhy{}0.061152
29       rs11021711   \PYGZhy{}0.060124
30       rs28691231   \PYGZhy{}0.049795
31     rs1269243287   \PYGZhy{}0.049795
32       rs34572188   \PYGZhy{}0.049509
33        rs2412116   \PYGZhy{}0.043475
34         rs375017    \PYGZhy{}0.03843
35        rs7666159   \PYGZhy{}0.033879
36        rs4416502   \PYGZhy{}0.030128
37        rs9330264   \PYGZhy{}0.027804
38         rs734073   \PYGZhy{}0.023279
39       rs55805734   \PYGZhy{}0.021777
40        rs8064765   \PYGZhy{}0.019273
41        rs4796663   \PYGZhy{}0.015331
42       rs62075803   \PYGZhy{}0.015331
43       rs12510869   \PYGZhy{}0.009278
44        rs3850379   \PYGZhy{}0.000811
45       rs10515816   \PYGZhy{}0.000433
46        rs3912643   \PYGZhy{}0.000415
47       rs13188899    \PYGZhy{}0.00041
48        rs4921799   \PYGZhy{}0.000409
49        rs4897753   \PYGZhy{}0.000298
50           rs6964   \PYGZhy{}0.000209
51        rs3806760   \PYGZhy{}0.000191
52        rs4028634   \PYGZhy{}0.000161
53       rs11579790   \PYGZhy{}0.000147
54         rs379066   \PYGZhy{}0.000132
55        rs3850745   \PYGZhy{}0.000123
56        rs4841589   \PYGZhy{}0.000072
57       rs12499663   \PYGZhy{}0.000069
58       rs74609071    0.000652
59       rs35456861    0.001887
60        rs9985581    0.009368
61        rs6842271    0.009368
62       rs34288580    0.009444
63      rs148514732    0.012629
64        rs7515370    0.020841
65           rs5848    0.023656
66       rs77312060    0.026649
67       rs72838312     0.02777
68         rs444618    0.029691
69       rs12995314    0.031652
70       rs62190394    0.031652
71       rs10110312    0.033873
72       rs12543164    0.035274
73        rs2075583    0.035907
74        rs6532190    0.039457
75       rs17324625    0.051377
76        rs7682766    0.058691
77      rs143756122    0.060175
78      rs148894916    0.060175
79       rs11264302    0.060206
80       rs71371995    0.061233
81       rs12150561    0.063362
82         rs494312    0.066012
83      rs536718528    0.066406
84       rs12935995    0.070272
85        rs2410595    0.070705
86        rs7104332    0.077242
87        rs4331494    0.077355
88        rs7734182    0.085825
89       rs35933728    0.086571
90       rs17016235    0.090649
91          rs34333    0.112067
92      rs201304809    0.120855
93       rs12434297    0.130994
94       rs11589479    0.132404
95        rs9799610    0.162529
96       rs72803476    0.163414
97       rs35776335    0.173641
98        rs2128786    0.189926
99       rs72846765    0.194033
100       rs6599389    0.196567
101      rs73211813    0.203329
102       rs7387252     0.20655
103       rs1800606     0.21257
104        rs208024    0.219757
105       rs9971953    0.254225
106       rs9971789    0.254225
107       rs7520918    0.289942
108      rs13161496    0.291558
109       rs3785891    0.302039
110        rs764324    0.306943
111       rs4241591    0.308725
112      rs11248057     0.32366
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{NI Females}
\label{\detokenize{Cooper:ni-females}}

\subsection{Logistic regression model}
\label{\detokenize{Cooper:id19}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{table1} \PYG{o}{=} \PYG{n}{table}\PYG{p}{[}\PYG{p}{(}\PYG{n}{table}\PYG{o}{.}\PYG{n}{gender} \PYG{o}{==} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{M}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)} \PYG{o}{\PYGZam{}} \PYG{p}{(}\PYG{n}{table}\PYG{o}{.}\PYG{n}{inv\PYGZus{}genotype}\PYG{o}{==}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{NI}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{]}
\PYG{n}{X} \PYG{o}{=} \PYG{n}{table1}\PYG{p}{[}\PYG{n}{table1}\PYG{o}{.}\PYG{n}{columns}\PYG{p}{[}\PYG{l+m+mi}{5}\PYG{p}{:}\PYG{p}{]}\PYG{p}{]}
\PYG{n}{Y} \PYG{o}{=} \PYG{n}{table1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{phenotype}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{lr} \PYG{o}{=} \PYG{n}{LogisticRegression}\PYG{p}{(}\PYG{n}{random\PYGZus{}state}\PYG{o}{=}\PYG{l+m+mi}{42}\PYG{p}{,} \PYG{n}{solver}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{saga}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{n\PYGZus{}jobs}\PYG{o}{=}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{penalty}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{elasticnet}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{table1}\PYG{o}{.}\PYG{n}{groupby}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{phenotype}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{participant\PYGZus{}id}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{nunique}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
phenotype
0    480
1    477
Name: participant\PYGZus{}id, dtype: int64
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Grid search for 3 hyperparameters}
\label{\detokenize{Cooper:id20}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} parameters = \PYGZob{}\PYGZsq{}C\PYGZsq{}: [0.005, 0.01, 0.02, 0.05, 0.1, 0.5, 1, 10, 20, 30],}
\PYG{c+c1}{\PYGZsh{}               \PYGZsq{}max\PYGZus{}iter\PYGZsq{}: [10, 25, 50, 75, 100, 150, 200, 400, 800, 1600],}
\PYG{c+c1}{\PYGZsh{}               \PYGZsq{}l1\PYGZus{}ratio\PYGZsq{}: [1, 0.9, 0.8, 0.7, 0.6, 0.5, 0.4, 0.3, 0.2, 0.1]\PYGZcb{}}

\PYG{n}{parameters} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+m+mf}{0.005}\PYG{p}{,} \PYG{l+m+mf}{0.01}\PYG{p}{]}\PYG{p}{,}
              \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{max\PYGZus{}iter}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{l+m+mi}{25}\PYG{p}{]}\PYG{p}{,}
              \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{l1\PYGZus{}ratio}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+m+mf}{0.2}\PYG{p}{,} \PYG{l+m+mf}{0.1}\PYG{p}{]}\PYG{p}{\PYGZcb{}}

\PYG{n}{grid\PYGZus{}lr} \PYG{o}{=} \PYG{n}{GridSearchCV}\PYG{p}{(}\PYG{n}{lr}\PYG{p}{,} \PYG{n}{parameters}\PYG{p}{,} \PYG{n}{verbose}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{,} \PYG{n}{scoring}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{roc\PYGZus{}auc}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{n\PYGZus{}jobs}\PYG{o}{=}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{cv}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{)}
\PYG{k}{if} \PYG{o+ow}{not} \PYG{n}{sys}\PYG{o}{.}\PYG{n}{warnoptions}\PYG{p}{:}
    \PYG{n}{warnings}\PYG{o}{.}\PYG{n}{simplefilter}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ignore}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{category}\PYG{o}{=}\PYG{n}{ConvergenceWarning}\PYG{p}{)}
    \PYG{n}{os}\PYG{o}{.}\PYG{n}{environ}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{PYTHONWARNINGS}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ignore}\PYG{l+s+s2}{\PYGZdq{}} \PYG{c+c1}{\PYGZsh{} Also affect subprocesses}
\PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{n}{X}\PYG{p}{,} \PYG{n}{Y}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
GridSearchCV(cv=10,
             estimator=LogisticRegression(n\PYGZus{}jobs=\PYGZhy{}1, penalty=\PYGZsq{}elasticnet\PYGZsq{},
                                          random\PYGZus{}state=42, solver=\PYGZsq{}saga\PYGZsq{}),
             n\PYGZus{}jobs=\PYGZhy{}1,
             param\PYGZus{}grid=\PYGZob{}\PYGZsq{}C\PYGZsq{}: [0.005, 0.01], \PYGZsq{}l1\PYGZus{}ratio\PYGZsq{}: [0.2, 0.1],
                         \PYGZsq{}max\PYGZus{}iter\PYGZsq{}: [10, 25]\PYGZcb{},
             scoring=\PYGZsq{}roc\PYGZus{}auc\PYGZsq{}, verbose=False)
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Best estimator}
\label{\detokenize{Cooper:id21}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{best\PYGZus{}lr} \PYG{o}{=} \PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{best\PYGZus{}estimator\PYGZus{}}

\PYG{n}{max\PYGZus{}auc\PYGZus{}score} \PYG{o}{=} \PYG{n}{roc\PYGZus{}auc\PYGZus{}score}\PYG{p}{(}\PYG{n}{Y}\PYG{p}{,} \PYG{n}{best\PYGZus{}lr}\PYG{o}{.}\PYG{n}{predict\PYGZus{}proba}\PYG{p}{(}\PYG{n}{X}\PYG{p}{)}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{coefs} \PYG{o}{=} \PYG{n}{best\PYGZus{}lr}\PYG{o}{.}\PYG{n}{coef\PYGZus{}}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{p}{:}\PYG{p}{]}
\PYG{n}{num\PYGZus{}coef} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n}{coefs} \PYG{o}{!=} \PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{n}{X\PYGZus{}header} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{n}{X}\PYG{o}{.}\PYG{n}{columns}\PYG{p}{)}

\PYG{n}{data\PYGZus{}array} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{vstack}\PYG{p}{(}\PYG{p}{(}\PYG{n}{X\PYGZus{}header}\PYG{p}{,} \PYG{n}{coefs}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{model\PYGZus{}coefs} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n}{data}\PYG{o}{=}\PYG{n}{data\PYGZus{}array}\PYG{o}{.}\PYG{n}{T}\PYG{p}{,} \PYG{n}{columns}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{SNP}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Coefficient}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Max AUC score:}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{max\PYGZus{}auc\PYGZus{}score}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Non\PYGZhy{}zero coefficients: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{num\PYGZus{}coef}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Best estimator: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{best\PYGZus{}estimator\PYGZus{}}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Scorer: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{scorer\PYGZus{}}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Best params: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{best\PYGZus{}params\PYGZus{}}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Best score: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{best\PYGZus{}score\PYGZus{}}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{m} \PYG{o}{=} \PYG{n}{model\PYGZus{}coefs}\PYG{p}{[}\PYG{n}{model\PYGZus{}coefs}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Coefficient}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{!=} \PYG{l+m+mi}{0} \PYG{p}{]}\PYG{o}{.}\PYG{n}{sort\PYGZus{}values}\PYG{p}{(}\PYG{n}{by}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Coefficient}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{m} \PYG{o}{=} \PYG{n}{m}\PYG{o}{.}\PYG{n}{reset\PYGZus{}index}\PYG{p}{(}\PYG{n}{drop}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}\PYG{o}{.}\PYG{n}{assign}\PYG{p}{(}\PYG{n}{Index}\PYG{o}{=}\PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{m}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{m}\PYG{o}{.}\PYG{n}{Index}\PYG{o}{=} \PYG{n}{m}\PYG{o}{.}\PYG{n}{Index} \PYG{o}{+} \PYG{l+m+mi}{1}
\PYG{n}{m}\PYG{o}{.}\PYG{n}{set\PYGZus{}index}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Index}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Max AUC score:0.5835888364779874

Non\PYGZhy{}zero coefficients: 4

Best estimator: LogisticRegression(C=0.005, l1\PYGZus{}ratio=0.1, max\PYGZus{}iter=25, n\PYGZus{}jobs=\PYGZhy{}1,
                   penalty=\PYGZsq{}elasticnet\PYGZsq{}, random\PYGZus{}state=42, solver=\PYGZsq{}saga\PYGZsq{})
Scorer: make\PYGZus{}scorer(roc\PYGZus{}auc\PYGZus{}score, needs\PYGZus{}threshold=True)
Best params: \PYGZob{}\PYGZsq{}C\PYGZsq{}: 0.005, \PYGZsq{}l1\PYGZus{}ratio\PYGZsq{}: 0.1, \PYGZsq{}max\PYGZus{}iter\PYGZsq{}: 25\PYGZcb{}
Best score: 0.5212733636229314
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
             SNP Coefficient
Index                       
1      rs7520918   \PYGZhy{}0.011899
2      rs9985581    0.016555
3      rs6842271    0.016555
4      rs3806760    0.027075
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\section{II Females}
\label{\detokenize{Cooper:ii-females}}

\subsection{Logistic regression model}
\label{\detokenize{Cooper:id22}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{table1} \PYG{o}{=} \PYG{n}{table}\PYG{p}{[}\PYG{p}{(}\PYG{n}{table}\PYG{o}{.}\PYG{n}{gender} \PYG{o}{==} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{F}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)} \PYG{o}{\PYGZam{}} \PYG{p}{(}\PYG{n}{table}\PYG{o}{.}\PYG{n}{inv\PYGZus{}genotype}\PYG{o}{==}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{II}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{]}
\PYG{n}{X} \PYG{o}{=} \PYG{n}{table1}\PYG{p}{[}\PYG{n}{table1}\PYG{o}{.}\PYG{n}{columns}\PYG{p}{[}\PYG{l+m+mi}{5}\PYG{p}{:}\PYG{p}{]}\PYG{p}{]}
\PYG{n}{Y} \PYG{o}{=} \PYG{n}{table1}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{phenotype}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{lr} \PYG{o}{=} \PYG{n}{LogisticRegression}\PYG{p}{(}\PYG{n}{random\PYGZus{}state}\PYG{o}{=}\PYG{l+m+mi}{42}\PYG{p}{,} \PYG{n}{solver}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{saga}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{n\PYGZus{}jobs}\PYG{o}{=}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{penalty}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{elasticnet}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{table1}\PYG{o}{.}\PYG{n}{groupby}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{phenotype}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{participant\PYGZus{}id}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{nunique}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
phenotype
0    195
1    175
Name: participant\PYGZus{}id, dtype: int64
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Grid search for 3 hyperparameters}
\label{\detokenize{Cooper:id23}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} parameters = \PYGZob{}\PYGZsq{}C\PYGZsq{}: [0.005, 0.01, 0.02, 0.05, 0.1, 0.5, 1, 10, 20, 30],}
\PYG{c+c1}{\PYGZsh{}               \PYGZsq{}max\PYGZus{}iter\PYGZsq{}: [10, 25, 50, 75, 100, 150, 200, 400, 800, 1600],}
\PYG{c+c1}{\PYGZsh{}               \PYGZsq{}l1\PYGZus{}ratio\PYGZsq{}: [1, 0.9, 0.8, 0.7, 0.6, 0.5, 0.4, 0.3, 0.2, 0.1]\PYGZcb{}}

\PYG{n}{parameters} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{10}\PYG{p}{,} \PYG{l+m+mi}{20}\PYG{p}{]}\PYG{p}{,}
              \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{max\PYGZus{}iter}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+m+mi}{1600}\PYG{p}{,} \PYG{l+m+mi}{3200}\PYG{p}{]}\PYG{p}{,}
              \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{l1\PYGZus{}ratio}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mf}{0.9}\PYG{p}{]}\PYG{p}{\PYGZcb{}}

\PYG{n}{grid\PYGZus{}lr} \PYG{o}{=} \PYG{n}{GridSearchCV}\PYG{p}{(}\PYG{n}{lr}\PYG{p}{,} \PYG{n}{parameters}\PYG{p}{,} \PYG{n}{verbose}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{,} \PYG{n}{scoring}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{roc\PYGZus{}auc}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{n\PYGZus{}jobs}\PYG{o}{=}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{cv}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{)}
\PYG{k}{if} \PYG{o+ow}{not} \PYG{n}{sys}\PYG{o}{.}\PYG{n}{warnoptions}\PYG{p}{:}
    \PYG{n}{warnings}\PYG{o}{.}\PYG{n}{simplefilter}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ignore}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{category}\PYG{o}{=}\PYG{n}{ConvergenceWarning}\PYG{p}{)}
    \PYG{n}{os}\PYG{o}{.}\PYG{n}{environ}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{PYTHONWARNINGS}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ignore}\PYG{l+s+s2}{\PYGZdq{}} \PYG{c+c1}{\PYGZsh{} Also affect subprocesses}
\PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{n}{X}\PYG{p}{,} \PYG{n}{Y}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
GridSearchCV(cv=10,
             estimator=LogisticRegression(n\PYGZus{}jobs=\PYGZhy{}1, penalty=\PYGZsq{}elasticnet\PYGZsq{},
                                          random\PYGZus{}state=42, solver=\PYGZsq{}saga\PYGZsq{}),
             n\PYGZus{}jobs=\PYGZhy{}1,
             param\PYGZus{}grid=\PYGZob{}\PYGZsq{}C\PYGZsq{}: [1, 10, 20], \PYGZsq{}l1\PYGZus{}ratio\PYGZsq{}: [1, 0.9],
                         \PYGZsq{}max\PYGZus{}iter\PYGZsq{}: [1600, 3200]\PYGZcb{},
             scoring=\PYGZsq{}roc\PYGZus{}auc\PYGZsq{}, verbose=False)
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}

\subsection{Best estimator}
\label{\detokenize{Cooper:id24}}
\begin{sphinxuseclass}{cell}\begin{sphinxVerbatimInput}

\begin{sphinxuseclass}{cell_input}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{best\PYGZus{}lr} \PYG{o}{=} \PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{best\PYGZus{}estimator\PYGZus{}}

\PYG{n}{max\PYGZus{}auc\PYGZus{}score} \PYG{o}{=} \PYG{n}{roc\PYGZus{}auc\PYGZus{}score}\PYG{p}{(}\PYG{n}{Y}\PYG{p}{,} \PYG{n}{best\PYGZus{}lr}\PYG{o}{.}\PYG{n}{predict\PYGZus{}proba}\PYG{p}{(}\PYG{n}{X}\PYG{p}{)}\PYG{p}{[}\PYG{p}{:}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{coefs} \PYG{o}{=} \PYG{n}{best\PYGZus{}lr}\PYG{o}{.}\PYG{n}{coef\PYGZus{}}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{p}{:}\PYG{p}{]}
\PYG{n}{num\PYGZus{}coef} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{n}{coefs} \PYG{o}{!=} \PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{n}{X\PYGZus{}header} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{n}{X}\PYG{o}{.}\PYG{n}{columns}\PYG{p}{)}

\PYG{n}{data\PYGZus{}array} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{vstack}\PYG{p}{(}\PYG{p}{(}\PYG{n}{X\PYGZus{}header}\PYG{p}{,} \PYG{n}{coefs}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{model\PYGZus{}coefs} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n}{data}\PYG{o}{=}\PYG{n}{data\PYGZus{}array}\PYG{o}{.}\PYG{n}{T}\PYG{p}{,} \PYG{n}{columns}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{SNP}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Coefficient}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Max AUC score:}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{max\PYGZus{}auc\PYGZus{}score}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Non\PYGZhy{}zero coefficients: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{num\PYGZus{}coef}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Best estimator: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{best\PYGZus{}estimator\PYGZus{}}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Scorer: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{scorer\PYGZus{}}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Best params: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{best\PYGZus{}params\PYGZus{}}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Best score: }\PYG{l+s+si}{\PYGZob{}}\PYG{n}{grid\PYGZus{}lr}\PYG{o}{.}\PYG{n}{best\PYGZus{}score\PYGZus{}}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{m} \PYG{o}{=} \PYG{n}{model\PYGZus{}coefs}\PYG{p}{[}\PYG{n}{model\PYGZus{}coefs}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Coefficient}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{!=} \PYG{l+m+mi}{0} \PYG{p}{]}\PYG{o}{.}\PYG{n}{sort\PYGZus{}values}\PYG{p}{(}\PYG{n}{by}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Coefficient}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{m} \PYG{o}{=} \PYG{n}{m}\PYG{o}{.}\PYG{n}{reset\PYGZus{}index}\PYG{p}{(}\PYG{n}{drop}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}\PYG{o}{.}\PYG{n}{assign}\PYG{p}{(}\PYG{n}{Index}\PYG{o}{=}\PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{m}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{m}\PYG{o}{.}\PYG{n}{Index}\PYG{o}{=} \PYG{n}{m}\PYG{o}{.}\PYG{n}{Index} \PYG{o}{+} \PYG{l+m+mi}{1}
\PYG{n}{m}\PYG{o}{.}\PYG{n}{set\PYGZus{}index}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Index}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimInput}
\begin{sphinxVerbatimOutput}

\begin{sphinxuseclass}{cell_output}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
Max AUC score:0.8847765567765569

Non\PYGZhy{}zero coefficients: 131

Best estimator: LogisticRegression(C=10, l1\PYGZus{}ratio=1, max\PYGZus{}iter=3200, n\PYGZus{}jobs=\PYGZhy{}1,
                   penalty=\PYGZsq{}elasticnet\PYGZsq{}, random\PYGZus{}state=42, solver=\PYGZsq{}saga\PYGZsq{})
Scorer: make\PYGZus{}scorer(roc\PYGZus{}auc\PYGZus{}score, needs\PYGZus{}threshold=True)
Best params: \PYGZob{}\PYGZsq{}C\PYGZsq{}: 10, \PYGZsq{}l1\PYGZus{}ratio\PYGZsq{}: 1, \PYGZsq{}max\PYGZus{}iter\PYGZsq{}: 3200\PYGZcb{}
Best score: 0.5429274165806673
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                SNP Coefficient
Index                          
1       rs138844738   \PYGZhy{}4.155261
2       rs115879964   \PYGZhy{}4.155261
3       rs536718528   \PYGZhy{}3.617586
4       rs115448944   \PYGZhy{}3.150895
5        rs71607338    \PYGZhy{}2.57904
6        rs17324625   \PYGZhy{}2.427067
7         rs2433733   \PYGZhy{}1.988805
8         rs6842271   \PYGZhy{}1.715214
9        rs62075803   \PYGZhy{}1.652955
10        rs4796663   \PYGZhy{}1.652955
11      rs112957100   \PYGZhy{}1.549041
12       rs79976845   \PYGZhy{}1.439649
13       rs74950708   \PYGZhy{}1.321806
14       rs11021711   \PYGZhy{}1.198849
15        rs1065712   \PYGZhy{}1.095391
16         rs444618   \PYGZhy{}1.090401
17       rs13131187   \PYGZhy{}1.017069
18         rs375017   \PYGZhy{}1.003348
19       rs11248057   \PYGZhy{}0.968769
20         rs494312   \PYGZhy{}0.932152
21        rs3733349   \PYGZhy{}0.883251
22      rs140859835   \PYGZhy{}0.836965
23        rs7535292   \PYGZhy{}0.718728
24        rs7515378   \PYGZhy{}0.699743
25         rs734073   \PYGZhy{}0.657171
26       rs76848738   \PYGZhy{}0.613196
27        rs4482120   \PYGZhy{}0.610804
28        rs6871718   \PYGZhy{}0.604013
29      rs112318363   \PYGZhy{}0.522652
30       rs74609071   \PYGZhy{}0.505636
31       rs12499663   \PYGZhy{}0.467277
32       rs77312060   \PYGZhy{}0.455806
33        rs3744427   \PYGZhy{}0.437119
34       rs12434297   \PYGZhy{}0.431097
35       rs11589479   \PYGZhy{}0.430368
36        rs7666159   \PYGZhy{}0.427637
37          rs34333   \PYGZhy{}0.413831
38       rs10110312   \PYGZhy{}0.399533
39        rs4921799   \PYGZhy{}0.395144
40        rs1372420   \PYGZhy{}0.388175
41       rs10515816   \PYGZhy{}0.384538
42        rs1736103   \PYGZhy{}0.381249
43       rs73211813   \PYGZhy{}0.354654
44       rs10448130    \PYGZhy{}0.33797
45         rs764324   \PYGZhy{}0.313281
46        rs4841589   \PYGZhy{}0.298304
47         rs999361   \PYGZhy{}0.278567
48        rs7387252   \PYGZhy{}0.254134
49       rs72846765   \PYGZhy{}0.253638
50       rs71371995   \PYGZhy{}0.187556
51       rs34992950   \PYGZhy{}0.183292
52       rs11579790   \PYGZhy{}0.141663
53        rs9971953   \PYGZhy{}0.140982
54        rs9971789   \PYGZhy{}0.140982
55        rs7520918   \PYGZhy{}0.132976
56       rs35933728   \PYGZhy{}0.128462
57       rs13161496   \PYGZhy{}0.126504
58       rs28691231   \PYGZhy{}0.113809
59        rs4859611   \PYGZhy{}0.081506
60         rs379066   \PYGZhy{}0.054031
61       rs72803476   \PYGZhy{}0.048141
62        rs7826007   \PYGZhy{}0.021814
63       rs35456861    \PYGZhy{}0.01947
64      rs148514732   \PYGZhy{}0.010154
65        rs9330264   \PYGZhy{}0.008158
66       rs72838312   \PYGZhy{}0.000916
67       rs12543164    0.007514
68        rs1501467    0.008177
69      rs150107452    0.029482
70        rs4241591    0.036761
71     rs1269243287    0.044491
72        rs2128786    0.051102
73        rs2075583    0.066752
74        rs3785891    0.091773
75       rs12995314    0.108912
76       rs62190394    0.108912
77        rs1949362    0.110172
78        rs7682766    0.120521
79        rs6532182     0.12645
80        rs4331494    0.140858
81       rs12935995    0.148705
82        rs1859223    0.150722
83        rs7104332    0.155063
84        rs3850745    0.219926
85       rs11097213    0.221927
86      rs117979807    0.232891
87        rs2410595      0.2445
88       rs35776335    0.287265
89       rs12101192    0.326314
90        rs4495967    0.341328
91       rs79828056    0.353429
92       rs11264302    0.368833
93       rs17016235    0.383153
94        rs6532190    0.383153
95       rs34572188    0.393827
96         rs208024    0.402916
97       rs13188899    0.430538
98           rs6964    0.445559
99       rs75214905    0.458369
100       rs3822023    0.458818
101        rs231454    0.496512
102       rs4897753    0.501664
103      rs11097297    0.514293
104     rs148894916    0.565314
105     rs143756122    0.565314
106     rs201304809    0.586162
107      rs10831599    0.612322
108       rs7515370    0.632874
109       rs9799610    0.642287
110       rs2412116    0.660505
111     rs112270735    0.673886
112      rs12150561     0.82272
113       rs7734182    0.898797
114       rs6836715    0.936025
115      rs78197677    0.968978
116       rs6599389    1.057432
117      rs34288580    1.086857
118          rs5848     1.09313
119       rs3806760    1.103029
120     rs142448570    1.167941
121      rs41311559    1.289618
122       rs9985581    1.394087
123       rs3850379    1.404536
124      rs55805734    1.418262
125     rs117230705    1.559671
126      rs74677851    1.919257
127       rs4028634    2.386557
128      rs11601088    2.926625
129       rs1800606    3.409027
130       rs8064765    5.881005
131      rs79531911    7.603942
\end{sphinxVerbatim}

\end{sphinxuseclass}\end{sphinxVerbatimOutput}

\end{sphinxuseclass}






\renewcommand{\indexname}{Index}
\printindex
\end{document}